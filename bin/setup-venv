#!/bin/bash

### Creates or updates the Python virtual environment
# Performs the following actions:
#   - creates the venv if it does not exist yet
#   - installs and/or upgrades PIP packages from 'requirements.txt'


## Activate the project environment
source "$(dirname "$(readlink -f "$0")")/activate"


## Create the virtual environment, if it does not exist yet
if [[ ! -d "$ANSIBLESITE_VENV" ]]; then
    python3 -m venv "$ANSIBLESITE_VENV" || exit $?
fi


## Activate the virtual environment
source "$ANSIBLESITE_VENV/bin/activate" || exit $?


## Install PIP packages from 'requirements.txt'
pip install -U -r "$ANSIBLESITE/requirements.txt"
